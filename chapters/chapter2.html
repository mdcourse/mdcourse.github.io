<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Initialize the simulation" href="chapter3.html" /><link rel="prev" title="Start coding" href="chapter1.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Setting Up the Simulation - </title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=f37a7f7d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo-py.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Code</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="chapter1.html">Start coding</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Setting Up the Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter3.html">Initialize the simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter4.html">Minimize the energy</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter5.html">Output the simulation state</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter6.html">Monte Carlo move</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter7.html">Pressure measurement</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Illustration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../projects/project1.html">A Monte Carlo study of argon</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../divers/bibliography.html">Bibliography</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/chapters/chapter2.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="setting-up-the-simulation">
<h1>Setting Up the Simulation<a class="headerlink" href="#setting-up-the-simulation" title="Link to this heading">¶</a></h1>
<p>To streamline the simulation process, all user-specified parameters will be
non-dimensionalized. By removing units from the calculations, we simplify
complex operations like force evaluation, making the code more efficient and
easier to manage. This non-dimensionalization is handled within the <em>Prepare</em>
class.</p>
<p>While this step may not be the most thrilling aspect of the simulation, it is
essential groundwork that will significantly ease our work as we progress.</p>
<section id="unit-systems">
<h2>Unit systems<a class="headerlink" href="#unit-systems" title="Link to this heading">¶</a></h2>
<p>In this code, two unit systems are employed: <em>real</em> and <em>LJ</em>, with <em>LJ</em> standing
for Lennard-Jones. The <em>real</em> unit system is used for both inputs and outputs,
while the <em>LJ</em> unit system is used for all internal calculations.</p>
<p>The <em>real</em> unit system follows the conventions outlined in the <a href="https://docs.lammps.org/units.html" target="_blank">LAMMPS unit systems</a>:</p>
<ul class="simple">
<li><p>Masses are in grams per mole,</p></li>
<li><p>Distances are in Ångströms,</p></li>
<li><p>Time is in femtoseconds,</p></li>
<li><p>Energies are in kcal/mol,</p></li>
<li><p>Velocities are in Ångströms per femtosecond,</p></li>
<li><p>Forces are in (kcal/mol)/Ångström,</p></li>
<li><p>Temperature is in Kelvin,</p></li>
<li><p>Pressure is in atmospheres,</p></li>
<li><p>Density is in g/cm<sup>3</sup> (in 3D).</p></li>
</ul>
<p>The <em>real</em> unit system is conventional in molecular simulations. However, using
such a complex unit system for calculations would involve cumbersome prefactors.
To simplify, the <em>LJ</em> unit system is used for all calculations. In the <em>LJ</em> unit
system, all quantities are dimensionless. Masses, distances, and energies are
expressed as multiples of <span class="math notranslate nohighlight">\(m\)</span>, <span class="math notranslate nohighlight">\(\sigma\)</span>, and <span class="math notranslate nohighlight">\(\epsilon\)</span>,
which represent the mass and LJ parameters of the atoms. Other quantities are
derived from these three parameters:</p>
<ul class="simple">
<li><p>Time is in <span class="math notranslate nohighlight">\(tau = \sqrt{m \sigma^2 / \epsilon}\)</span>,</p></li>
<li><p>Energies are in <span class="math notranslate nohighlight">\(\epsilon\)</span>,</p></li>
<li><p>Velocities are in <span class="math notranslate nohighlight">\(\sigma / \tau\)</span>,</p></li>
<li><p>Forces are in <span class="math notranslate nohighlight">\(\epsilon / \sigma\)</span>,</p></li>
<li><p>Temperature is in <span class="math notranslate nohighlight">\(\epsilon / k_\text{B}\)</span>,</p></li>
<li><p>Pressure is in <span class="math notranslate nohighlight">\(\epsilon / \sigma^3\)</span>,</p></li>
<li><p>Density is in <span class="math notranslate nohighlight">\(m / \sigma^3\)</span>,</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(k_\text{B}\)</span> is the Boltzmann constant.</p>
</section>
<section id="start-coding">
<h2>Start coding<a class="headerlink" href="#start-coding" title="Link to this heading">¶</a></h2>
<p>Let’s fill in the previously created class named Prepare. To facilitate unit
conversion, we will import <a href="https://numpy.org/" target="_blank">NumPy</a> and the constants module from <a href="https://scipy.org/" target="_blank">SciPy</a>.</p>
<p>In the file named <em>Prepare.py</em>, add the following lines:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">cst</span>
</pre></div>
</div>
<p>Four parameters are provided to the <em>Prepare</em> class:</p>
<ul class="simple">
<li><p>the atom masses <span class="math notranslate nohighlight">\(m\)</span>,</p></li>
<li><p>the LJ parameters <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\epsilon\)</span>,</p></li>
<li><p>and the number of atoms.</p></li>
</ul>
<p>All these quantities must be supplied as lists. This will be useful later when
we want to mix atoms of different types within the same simulation box.</p>
<p>Modify the <em>Prepare</em> class as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Prepare</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">number_atoms</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>  <span class="c1"># List - no unit</span>
                <span class="n">epsilon</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">],</span>  <span class="c1"># List - Kcal/mol</span>
                <span class="n">sigma</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>  <span class="c1"># List - Angstrom</span>
                <span class="n">atom_mass</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span>  <span class="c1"># List - g/mol</span>
                <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_atoms</span> <span class="o">=</span> <span class="n">number_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atom_mass</span> <span class="o">=</span> <span class="n">atom_mass</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, the four lists <em>number_atoms</em> <span class="math notranslate nohighlight">\(N\)</span>, <em>epsilon</em> <span class="math notranslate nohighlight">\(\epsilon\)</span>,
<em>sigma</em> <span class="math notranslate nohighlight">\(\sigma\)</span>, and <em>atom_mass</em> <span class="math notranslate nohighlight">\(m\)</span> are given default values of
<span class="math notranslate nohighlight">\(10\)</span>, <span class="math notranslate nohighlight">\(0.1~\text{[Kcal/mol]}\)</span>, <span class="math notranslate nohighlight">\(3~\text{[Å]}\)</span>, and
<span class="math notranslate nohighlight">\(10~\text{[g/mol]}\)</span>, respectively.</p>
<p>All four parameters are assigned to <em>self</em>, allowing other methods to access
them. The <em>args</em> and <em>kwargs</em> parameters are used to accept an arbitrary number
of positional and keyword arguments, respectively.</p>
</section>
<section id="calculate-lj-units-prefactors">
<h2>Calculate LJ units prefactors<a class="headerlink" href="#calculate-lj-units-prefactors" title="Link to this heading">¶</a></h2>
<p>Within the <em>Prepare</em> class, let us create a method called <em>calculate_LJunits_prefactors</em>
that will be used to calculate the prefactors necessary to convert units from the <em>real</em>
unit system to the <em>LJ</em> unit system:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_LJunits_prefactors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the Lennard-Jones units prefacors.&quot;&quot;&quot;</span>
    <span class="c1"># Define the reference distance, energy, and mass</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reference_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Angstrom</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reference_energy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># kcal/mol</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reference_mass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_mass</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># g/mol</span>

    <span class="c1"># Calculate the prefactor for the time</span>
    <span class="n">mass_kg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_mass</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">cst</span><span class="o">.</span><span class="n">kilo</span><span class="o">/</span><span class="n">cst</span><span class="o">.</span><span class="n">Avogadro</span>  <span class="c1"># kg</span>
    <span class="n">epsilon_J</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">cst</span><span class="o">.</span><span class="n">calorie</span><span class="o">*</span><span class="n">cst</span><span class="o">.</span><span class="n">kilo</span><span class="o">/</span><span class="n">cst</span><span class="o">.</span><span class="n">Avogadro</span>  <span class="c1"># J</span>
    <span class="n">sigma_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">cst</span><span class="o">.</span><span class="n">angstrom</span>  <span class="c1"># m</span>
    <span class="n">time_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mass_kg</span><span class="o">*</span><span class="n">sigma_m</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">epsilon_J</span><span class="p">)</span>  <span class="c1"># s</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reference_time</span> <span class="o">=</span> <span class="n">time_s</span> <span class="o">/</span> <span class="n">cst</span><span class="o">.</span><span class="n">femto</span>  <span class="c1"># fs</span>

    <span class="c1"># Calculate the prefactor for the temperature</span>
    <span class="n">kB</span> <span class="o">=</span> <span class="n">cst</span><span class="o">.</span><span class="n">Boltzmann</span><span class="o">*</span><span class="n">cst</span><span class="o">.</span><span class="n">Avogadro</span><span class="o">/</span><span class="n">cst</span><span class="o">.</span><span class="n">calorie</span><span class="o">/</span><span class="n">cst</span><span class="o">.</span><span class="n">kilo</span>  <span class="c1"># kcal/mol/K</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reference_temperature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">kB</span>  <span class="c1"># K</span>

    <span class="c1"># Calculate the prefactor for the pressure</span>
    <span class="n">pressure_pa</span> <span class="o">=</span> <span class="n">epsilon_J</span><span class="o">/</span><span class="n">sigma_m</span><span class="o">**</span><span class="mi">3</span>  <span class="c1"># Pa</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reference_pressure</span> <span class="o">=</span> <span class="n">pressure_pa</span><span class="o">/</span><span class="n">cst</span><span class="o">.</span><span class="n">atm</span>  <span class="c1"># atm</span>
</pre></div>
</div>
<p>This method defines the reference distance as the first element in the
<em>sigma</em> list, i.e., <span class="math notranslate nohighlight">\(\sigma_{11}\)</span>. Therefore, atoms of type one will
always be used for the normalization. Similarly, the first element
in the <em>epsilon</em> list (<span class="math notranslate nohighlight">\(\epsilon_{11}\)</span>) is used as the reference energy,
and the first element in the <em>atom_mass</em> list (<span class="math notranslate nohighlight">\(m_1\)</span>) is used as the
reference mass. Then, the reference_time in femtoseconds is calculated
as <span class="math notranslate nohighlight">\(\sqrt{m_1 \sigma_{11}^2 / \epsilon_{11}}\)</span>, the reference temperature
in Kelvin as <span class="math notranslate nohighlight">\(\epsilon_{11} / k_\text{B}\)</span>, and the reference_pressure
in atmospheres is calculated as <span class="math notranslate nohighlight">\(\epsilon_{11}/\sigma_{11}^3\)</span>.</p>
<p>Finally, let us ensure that the <em>calculate_LJunits_prefactors</em> method is
called systematically by adding the following line to the <em>__init__()</em> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">calculate_LJunits_prefactors</span><span class="p">()</span>
</pre></div>
</div>
<p>Every time the <em>Prepare</em> class is initialized, all reference values will
be calculated and stored as attributes of <em>self</em>.</p>
</section>
<section id="nondimensionalize-units">
<h2>Nondimensionalize units<a class="headerlink" href="#nondimensionalize-units" title="Link to this heading">¶</a></h2>
<p>Let us take advantage of the calculated reference values and normalize the
three inputs of the <em>Prepare</em> class that have physical dimensions, i.e.,
<em>epsilon</em>, <em>sigma</em>, and <em>atom_mass</em>.</p>
<p>Create a new method called <em>nondimensionalize_units_0</em> within the <em>Prepare</em>
class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">nondimensionalize_units_0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Normalize LJ properties</span>
    <span class="n">epsilon</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">atom_mass</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">e0</span><span class="p">,</span> <span class="n">s0</span><span class="p">,</span> <span class="n">m0</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_mass</span><span class="p">):</span>
        <span class="n">epsilon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_energy</span><span class="p">)</span>
        <span class="n">sigma</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_distance</span><span class="p">)</span>
        <span class="n">atom_mass</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">reference_mass</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">atom_mass</span> <span class="o">=</span> <span class="n">atom_mass</span>
</pre></div>
</div>
<p>The index <em>0</em> is used to differentiate this method from other methods that
will be used to nondimensionalize units in future classes. We anticipate that
<em>epsilon</em>, <em>sigma</em>, and <em>atom_mass</em> may contain more than one element, so
each element is normalized with the corresponding reference value. The
<em>zip()</em> function allows us to loop over all three lists at once.</p>
<p>Let us also call the <em>nondimensionalize_units_0</em> from the <em>__init__()</em> method
of the <em>Prepare</em> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">calculate_LJunits_prefactors</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nondimensionalize_units_0</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="identify-atom-properties">
<h2>Identify atom properties<a class="headerlink" href="#identify-atom-properties" title="Link to this heading">¶</a></h2>
<p>Anticipating the future use of multiple atom types, where each type will be
associated with its own <span class="math notranslate nohighlight">\(\sigma\)</span>, <span class="math notranslate nohighlight">\(\epsilon\)</span>, and <span class="math notranslate nohighlight">\(m\)</span>, let
us create arrays containing the properties of each atom in the simulation. For
instance, in the case of a simulation with two atoms of type 1 and three atoms
of type 2, the corresponding <em>atoms_sigma</em> array will be:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{atoms_sigma} = [\sigma_{11}, \sigma_{11}, \sigma_{22}, \sigma_{22}, \sigma_{22}]\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{11}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{22}\)</span> are the sigma values for
atoms of type 1 and 2, respectively. The <em>atoms_sigma</em> array will allow for
future calculations of force.</p>
<p>Create a new method called <em>identify_atom_properties</em>, and place it
within the <em>Prepare</em> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">identify_atom_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Identify the atom properties for each atom.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">total_number_atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_atoms</span><span class="p">)</span>
    <span class="n">atoms_sigma</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">atoms_epsilon</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">atoms_mass</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">atoms_type</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">parts</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">atom_mass</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">number_atoms</span><span class="p">,</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_atoms</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">sigma</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">number_atoms</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">parts</span>
        <span class="n">atoms_sigma</span> <span class="o">+=</span> <span class="p">[</span><span class="n">sigma</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_atoms</span>
        <span class="n">atoms_epsilon</span> <span class="o">+=</span> <span class="p">[</span><span class="n">epsilon</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_atoms</span>
        <span class="n">atoms_mass</span> <span class="o">+=</span> <span class="p">[</span><span class="n">mass</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_atoms</span>
        <span class="n">atoms_type</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">type</span><span class="p">]</span> <span class="o">*</span> <span class="n">number_atoms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">atoms_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atoms_sigma</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">atoms_epsilon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atoms_epsilon</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">atoms_mass</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atoms_mass</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">atoms_type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">atoms_type</span><span class="p">)</span>
</pre></div>
</div>
<p>Let us call the <em>identify_atom_properties</em> from the <em>__init__()</em> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nondimensionalize_units_0</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">identify_atom_properties</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="calculate-cross-coefficients">
<h2>Calculate cross coefficients<a class="headerlink" href="#calculate-cross-coefficients" title="Link to this heading">¶</a></h2>
<p>Let us calculate all cross coefficients that are required to calculate the interactions
between atom <span class="math notranslate nohighlight">\(i\)</span> and atom <span class="math notranslate nohighlight">\(j\)</span>. From the example described previously,
where:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\text{atoms_sigma} = [\sigma_{11}, \sigma_{11}, \sigma_{22}, \sigma_{22}, \sigma_{22}]\]</div>
</div>
<p>one expects all direct and cross coefficients to be:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\text{array_sigma_ij} = \begin{bmatrix}
        \sigma_{11} \text{(0-1)} &amp; \sigma_{12} \text{(0-2)} &amp; \sigma_{12} \text{(0-3)} &amp; \sigma_{12} \text{(0-4)} \\
                                 &amp; \sigma_{12} \text{(1-2)} &amp; \sigma_{12} \text{(1-3)} &amp; \sigma_{12} \text{(1-4)} \\
                                 &amp;                          &amp; \sigma_{22} \text{(2-3)} &amp; \sigma_{22} \text{(2-4)} \\
                                 &amp;                          &amp;                          &amp; \sigma_{22} \text{(3-4)} \\
    \end{bmatrix}\end{split}\]</div>
</div>
<p>where it is assumed that the matrix is symmetric, so the coefficients in the bottom
left corner are not specified. The first value in the top left corner of the matrix,
<span class="math notranslate nohighlight">\(\sigma_{11} \text{(0-1)}\)</span>, indicates that the <span class="math notranslate nohighlight">\(\sigma\)</span> value for the interaction
between the first (0) and second atom (1) is <span class="math notranslate nohighlight">\(\sigma_{11}\)</span>, as both atoms 0
and 1 are of type 1. A similar matrix can be written for epsilon_sigma_ij.</p>
<p>The values of the cross coefficients <span class="math notranslate nohighlight">\(\sigma_{12}\)</span> and <span class="math notranslate nohighlight">\(\epsilon_{12}\)</span>
are assumed to follow the arithmetic mean :</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}\sigma_{12} = (\sigma_{11}+\sigma_{22})/2 \\
\epsilon_{12} = (\epsilon_{11}+\epsilon_{22})/2\end{split}\]</div>
</div>
<p>Create the following method called <em>calculate_cross_coefficients</em> within the
<em>Prepare</em> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_cross_coefficients</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate all the cross-coefficients for the LJ interations.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">identify_atom_properties</span><span class="p">()</span>
    <span class="n">epsilon_ij</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sigma_ij</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_number_atoms</span><span class="p">):</span>
        <span class="n">epsilon_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms_epsilon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">sigma_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms_sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_number_atoms</span><span class="p">):</span>
            <span class="n">epsilon_j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms_epsilon</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">epsilon_ij</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">epsilon_i</span><span class="o">+</span><span class="n">epsilon_j</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">sigma_j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms_sigma</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">sigma_ij</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">sigma_i</span><span class="o">+</span><span class="n">sigma_j</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">array_epsilon_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">epsilon_ij</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">array_sigma_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sigma_ij</span><span class="p">)</span>
</pre></div>
</div>
<p>After calling for the <em>identify_atom_properties()</em> method, a double loop
is performed over all direct coefficients, and the cross coefficients
are stored within <em>array_sigma_ij</em> and <em>array_epsilon_ij</em>.</p>
<p>Finally, let us call the <em>calculate_cross_coefficients</em> method from the
<em>__init__()</em> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">identify_atom_properties</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">calculate_cross_coefficients</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="test-the-code">
<h2>Test the code<a class="headerlink" href="#test-the-code" title="Link to this heading">¶</a></h2>
<p>Let us test the <em>Prepare</em> class to make sure that it does what is expected.
This initiates a system with 2 atoms of type 1, and 3 atoms of type 2:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">Prepare</span> <span class="kn">import</span> <span class="n">Prepare</span>

<span class="n">prep</span> <span class="o">=</span> <span class="n">Prepare</span><span class="p">(</span><span class="n">number_atoms</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="n">epsilon</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="c1"># kcal/mol</span>
    <span class="n">sigma</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="c1"># A</span>
    <span class="n">atom_mass</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="c1"># g/mol</span>
    <span class="p">)</span>
<span class="k">assert</span> <span class="n">prep</span><span class="o">.</span><span class="n">reference_energy</span> <span class="o">==</span> <span class="mf">0.1</span>
<span class="k">assert</span> <span class="n">prep</span><span class="o">.</span><span class="n">reference_distance</span> <span class="o">==</span> <span class="mi">3</span>
<span class="k">assert</span> <span class="n">prep</span><span class="o">.</span><span class="n">reference_mass</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">assert</span> <span class="n">prep</span><span class="o">.</span><span class="n">total_number_atoms</span> <span class="o">==</span> <span class="mi">5</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">prep</span><span class="o">.</span><span class="n">total_number_atoms</span><span class="o">*</span><span class="p">(</span><span class="n">prep</span><span class="o">.</span><span class="n">total_number_atoms</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">prep</span><span class="o">.</span><span class="n">array_epsilon_ij</span><span class="p">)</span>
</pre></div>
</div>
<p>This test assert that the reference energy, distance, and mass were properly defined,
that the number of atoms indeed corresponds to the sum of the number of atoms of each
type, and that the length of the array_epsilon_ij array is consistent.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="chapter3.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Initialize the simulation</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="chapter1.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Start coding</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Setting Up the Simulation</a><ul>
<li><a class="reference internal" href="#unit-systems">Unit systems</a></li>
<li><a class="reference internal" href="#start-coding">Start coding</a></li>
<li><a class="reference internal" href="#calculate-lj-units-prefactors">Calculate LJ units prefactors</a></li>
<li><a class="reference internal" href="#nondimensionalize-units">Nondimensionalize units</a></li>
<li><a class="reference internal" href="#identify-atom-properties">Identify atom properties</a></li>
<li><a class="reference internal" href="#calculate-cross-coefficients">Calculate cross coefficients</a></li>
<li><a class="reference internal" href="#test-the-code">Test the code</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=01f34227"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>